<h1>Changelog</h1><h2>2.4.2 (Apr 15 2016)</h2><ul>
<li><p>Fix use of <code>in</code> operator with strings. Fixes
<a href="https://github.com/mozilla/nunjucks/issues/714">#714</a>. Thanks Zubrik for the
report.</p>
</li>
<li><p>Support ES2015 Map and Set in <code>length</code> filter. Merge of
<a href="https://github.com/mozilla/nunjucks/pull/705">#705</a>. Thanks ricordisamoa.</p>
</li>
<li><p>Remove truncation of long function names in error messages. Thanks Daniel
Bendavid. Merge of <a href="https://github.com/mozilla/nunjucks/pull/702">#702</a>.</p>
</li>
</ul>
<h2>2.4.1 (Mar 17 2016)</h2><ul>
<li><p>Don&#39;t double-escape. Thanks legutierr. Merge of
<a href="https://github.com/mozilla/nunjucks/pull/701">#701</a>.</p>
</li>
<li><p>Prevent filter.escape from escaping SafeString. Thanks atian25. Merge of
<a href="https://github.com/mozilla/nunjucks/pull/623">#623</a>.</p>
</li>
<li><p>Throw an error if a block is defined multiple times. Refs
<a href="https://github.com/mozilla/nunjucks/issues/696">#696</a>.</p>
</li>
<li><p>Officially recommend the <code>.njk</code> extension. Thanks David Kebler. Merge of
<a href="https://github.com/mozilla/nunjucks/pull/691">#691</a>.</p>
</li>
<li><p>Allow block-set to wrap an inheritance block. Unreported; fixed as a side
effect of the fix for <a href="https://github.com/mozilla/nunjucks/issues/576">#576</a>.</p>
</li>
<li><p>Fix <code>filter</code> tag with non-trivial contents. Thanks Stefan Cruz and Fabien
Franzen for report and investigation, Jan Oopkaup for failing tests. Fixes
<a href="https://github.com/mozilla/nunjucks/issues/576">#576</a>.</p>
</li>
</ul>
<h2>2.4.0 (Mar 10 2016)</h2><ul>
<li><p>Allow retrieving boolean-false as a global. Thanks Marius Büscher. Merge of
<a href="https://github.com/mozilla/nunjucks/pull/694">#694</a>.</p>
</li>
<li><p>Don&#39;t automatically convert any for-loop that has an include statement into
an async loop. Reverts
<a href="https://github.com/mozilla/nunjucks/commit/7d4716f4fd">7d4716f4fd</a>, re-opens
<a href="https://github.com/mozilla/nunjucks/issues/372">#372</a>, fixes
<a href="https://github.com/mozilla/nunjucks/issues/527">#527</a>. Thanks Tom Delmas for
the report.</p>
</li>
<li><p>Switch from Optimist to Yargs for argument-parsing. Thanks Bogdan
Chadkin. Merge of <a href="https://github.com/mozilla/nunjucks/pull/672">#672</a>.</p>
</li>
<li><p>Prevent includes from writing to their including scope. Merge of
<a href="https://github.com/mozilla/nunjucks/pull/667">#667</a> (only partially
backported to 2.x; macro var visibility not backported).</p>
</li>
<li><p>Fix handling of <code>dev</code> environment option, to get full tracebacks on errors
(including nunjucks internals). Thanks Tobias Petry and Chandrasekhar Ambula
V for the report, Aleksandr Motsjonov for draft patch.</p>
</li>
<li><p>Support using <code>in</code> operator to search in both arrays and objects,
and it will throw an error for other data types.
Fix <a href="https://github.com/mozilla/nunjucks/pull/659">#659</a>.
Thanks Alex Mayfield for report and test, Ouyang Yadong for fix.
Merge of <a href="https://github.com/mozilla/nunjucks/pull/661">#661</a>.</p>
</li>
<li><p>Add support for <code>{% set %}</code> block assignments as in jinja2. Thanks Daniele
Rapagnani. Merge of <a href="https://github.com/mozilla/nunjucks/pull/656">#656</a></p>
</li>
<li><p>Fix <code>{% set %}</code> scoping within macros.
Fixes <a href="https://github.com/mozilla/nunjucks/issues/577">#577</a> and
the macro portion of <a href="https://github.com/mozilla/nunjucks/issues/561">#561</a>.
Thanks Ouyang Yadong. Merge of <a href="https://github.com/mozilla/nunjucks/pull/653">#653</a>.</p>
</li>
<li><p>Add support for named <code>endblock</code> (e.g. <code>{% endblock foo %}</code>). Thanks
ricordisamoa. Merge of <a href="https://github.com/mozilla/nunjucks/pull/641">#641</a>.</p>
</li>
<li><p>Fix <code>range</code> global with zero as stop-value. Thanks Thomas Hunkapiller. Merge
of <a href="https://github.com/mozilla/nunjucks/pull/638">#638</a>.</p>
</li>
<li><p>Fix a bug in urlize that collapsed whitespace. Thanks Paulo Bu. Merge of
<a href="https://github.com/mozilla/nunjucks/pull/637">#637</a>.</p>
</li>
<li><p>Add <code>sum</code> filter. Thanks Pablo Matías Lazo. Merge of
<a href="https://github.com/mozilla/nunjucks/pull/629">#629</a>.</p>
</li>
<li><p>Don&#39;t suppress errors inside {% if %} tags. Thanks Artemy Tregubenko for
report and test, Ouyang Yadong for fix. Merge of
<a href="https://github.com/mozilla/nunjucks/pull/634">#634</a>.</p>
</li>
<li><p>Allow whitespace control on comment blocks, too. Thanks Ouyang Yadong. Merge
of <a href="https://github.com/mozilla/nunjucks/pull/632">#632</a>.</p>
</li>
<li><p>Fix whitespace control around nested tags/variables/comments. Thanks Ouyang
Yadong. Merge of <a href="https://github.com/mozilla/nunjucks/pull/631">#631</a>.</p>
</li>
</ul>
<h2>v2.3.0 (Jan 6 2016)</h2><ul>
<li><p>Return <code>null</code> from <code>WebLoader</code> on missing template instead of throwing an
error, for consistency with other loaders. This allows <code>WebLoader</code> to support
the new <code>ignore missing</code> flag on the <code>include</code> tag. If <code>ignore missing</code> is
not set, a generic &quot;template not found&quot; error will still be thrown, just like
for any other loader. Ajax errors other than 404 will still cause <code>WebLoader</code>
to throw an error directly.</p>
</li>
<li><p>Add preserve-linebreaks option to <code>striptags</code> filter. Thanks Ivan
Kleshnin. Merge of <a href="https://github.com/mozilla/nunjucks/pull/619">#619</a>.</p>
</li>
</ul>
<h2>v2.2.0 (Nov 23 2015)</h2><ul>
<li>Add <code>striptags</code> filter. Thanks Anthony Giniers. Merge of
<a href="https://github.com/mozilla/nunjucks/pull/589">#589</a>.</li>
<li>Allow compiled templates to be imported, included and extended. Thanks Luis
Gutierrez-Sheris. Merge of
<a href="https://github.com/mozilla/nunjucks/pull/581">#581</a>.</li>
<li>Fix issue with different nunjucks environments sharing same globals. Each
environment is now independent.  Thanks Paul Pechin. Merge of
<a href="https://github.com/mozilla/nunjucks/pull/574">#574</a>.</li>
<li>Add negative steps support for range function. Thanks Nikita Mostovoy. Merge
of <a href="https://github.com/mozilla/nunjucks/pull/575">#575</a>.</li>
<li>Remove deprecation warning when using the <code>default</code> filter without specifying
a third argument. Merge of
<a href="https://github.com/mozilla/nunjucks/pull/567">#567</a>.</li>
<li>Add support for chaining of addGlobal, addFilter, etc. Thanks Rob Graeber. Merge of
<a href="https://github.com/mozilla/nunjucks/pull/537">#537</a></li>
<li>Fix error propagation. Thanks Tom Delmas. Merge of
<a href="https://github.com/mozilla/nunjucks/pull/534">#534</a>.</li>
<li>trimBlocks now also trims windows style line endings. Thanks Magnus Tovslid. Merge of
<a href="https://github.com/mozilla/nunjucks/pull/548">#548</a></li>
<li><code>include</code> now supports an option to suppress errors if the template does not
exist. Thanks Mathias Nestler. Merge of
<a href="https://github.com/mozilla/nunjucks/pull/559">#559</a></li>
</ul>
<h2>v2.1.0 (Sep 21 2015)</h2><ul>
<li>Fix creating <code>WebLoader</code> without <code>opts</code>. Merge of
<a href="https://github.com/mozilla/nunjucks/pull/524">#524</a>.</li>
<li>Add <code>hasExtension</code> and <code>removeExtension</code> methods to <code>Environment</code>. Merge of
<a href="https://github.com/mozilla/nunjucks/pull/512">#512</a>.</li>
<li>Add support for kwargs in <code>sort</code> filter. Merge of
<a href="https://github.com/mozilla/nunjucks/pull/510">#510</a>.</li>
<li>Add <code>none</code> as a lexed constant evaluating to <code>null</code>. Merge of
<a href="https://github.com/mozilla/nunjucks/pull/480">#480</a>.</li>
<li>Fix rendering of multiple <code>raw</code> blocks. Thanks Aaron O&#39;Mullan. Merge of
<a href="https://github.com/mozilla/nunjucks/pull/503">#503</a>.</li>
<li>Avoid crashing on async loader error. Thanks Samy Pessé. Merge of
<a href="https://github.com/mozilla/nunjucks/pull/504">#504</a>.</li>
<li>Add support for keyword arguments for sort filter. Thanks Andres Pardini. Merge of
<a href="https://github.com/mozilla/nunjucks/pull/510">#510</a></li>
</ul>
<h2>v2.0.0 (Aug 30 2015)</h2><p>Most of the changes can be summed up in the
<a href="https://github.com/mozilla/nunjucks/issues?q=is%3Aissue+milestone%3A2.0+is%3Aclosed">issues tagged 2.0</a>.</p>
<p>Or you can
<a href="https://github.com/mozilla/nunjucks/compare/v1.3.4...f8aabccefc31a9ffaccdc6797938b5187e07ea87">see all commits</a>.</p>
<p>Most important changes:</p>
<ul>
<li><strong>autoescape is now on by default.</strong> You need to explicitly pass <code>{
autoescape: false }</code> in the options to turn it off.</li>
<li><strong>watch is off by default.</strong> You need to explicitly pass <code>{ watch: true }</code> to
start the watcher.</li>
<li>The <code>default</code> filter has changed. It will show the default value only if the
argument is <strong>undefined</strong>. Any other value, even false-y values like <code>false</code>
and <code>null</code>, will be returned. You can get back the old behavior by passing
<code>true</code> as a 3rd argument to activate the loose-y behavior: <code>foo |
default(&quot;bar&quot;, true)</code>. In 2.0 if you don&#39;t pass the 3rd argument, a warning
will be displayed about this change in behavior. In 2.1 this warning will be
removed.</li>
<li><a href="http://mozilla.github.io/nunjucks/templating.html#filter">New filter tag</a></li>
<li>Lots of other bug fixes and small features, view the above issue list!</li>
</ul>
<h2>v1.3.4 (Apr 27 2015)</h2><p>This is an extremely minor release that only adds an .npmignore so that the
bench, tests, and docs folders do not get published to npm. Nunjucks should
download a lot faster now.</p>
<h2>v1.3.3 (Apr 3 2015)</h2><p>This is exactly the same as v1.3.1, just fixing a typo in the git version tag.</p>
<h2>v1.3.2 (Apr 3 2015)</h2><p>(no notes)</p>
<h2>v1.3.1 (Apr 3 2015)</h2><p>We added strict mode to all the files, but that broke running nunjucks in the
browser. Should work now with this small fix.</p>
<h2>v1.3.0 (Apr 3 2015)</h2><ul>
<li>Relative templates: you can now load a template relatively by starting the
path with ., like ./foo.html</li>
<li>FileSystemLoader now takes a noCache option, if true will disable caching
entirely</li>
<li>Additional lstripBlocks and trimBlocks available to clean output
automatically</li>
<li>New selectattr and rejectattr filters</li>
<li>Small fixes to the watcher</li>
<li>Several bug fixes</li>
</ul>
<h2>v1.2.0 (Feb 4 2015)</h2><ul>
<li>The special non-line-breaking space is considered whitespace now</li>
<li>The in operator has a lower precedence now. This is potentially a breaking
change, thus the minor version bump. See
<a href="https://github.com/mozilla/nunjucks/pull/336">#336</a></li>
<li>import with context now implemented:
<a href="https://github.com/mozilla/nunjucks/pull/319">#319</a></li>
<li>async rendering doesn&#39;t throw compile errors</li>
</ul>
<h2>v1.1.0 (Sep 30 2014)</h2><p>User visible changes:</p>
<ul>
<li>Fix a bug in urlize that would remove periods</li>
<li>custom tag syntax (like {% and %}) was made Environment-specific
internally. Previously they were global even though you set them through the
Environment.</li>
<li>Remove aggressive optimization that only emitted loop variables when uses. It
introduced several bugs and didn&#39;t really improve perf.</li>
<li>Support the regular expression syntax like /foo/g.</li>
<li>The replace filter can take a regex as the first argument</li>
<li>The call tag was implemented</li>
<li>for tags can now take an else clause</li>
<li>The cycler object now exposes the current item as the current property</li>
<li>The chokidar library was updated and should fix various issues</li>
</ul>
<p>Dev changes:</p>
<ul>
<li>Test coverage now available via istanbul. Will automatically display after
running tests.</li>
</ul>
<h2>v1.0.7 (Aug 15 2014)</h2><p>Mixed up a few things in the 1.0.6 release, so another small bump. This merges
in one thing:</p>
<ul>
<li>The length filter will not throw an error is used on an undefined
variable. It will return 0 if the variable is undefined.</li>
</ul>
<h2>v1.0.6 (Aug 15 2014)</h2><ul>
<li>Added the addGlobal method to the Environment object</li>
<li>import/extends/include now can take an arbitrary expression</li>
<li>fix bugs in set</li>
<li>improve express integration (allows rendering templates without an extension)</li>
</ul>
<h2>v1.0.5 (May 1 2014)</h2><ul>
<li>Added support for browserify</li>
<li>Added option to specify template output path when precompiling templates</li>
<li>Keep version comment in browser minified files</li>
<li>Speed up SafeString implementation</li>
<li>Handle null and non-matching cases for word count filter</li>
<li>Added support for node-webkit</li>
<li>Other various minor bugfixes</li>
</ul>
<h2>chokidar repo fix - v1.0.4 (Apr 4 2014)</h2><ul>
<li>The chokidar dependency moved repos, and though the git URL should have been
forwarded some people were having issues. This fixed the repo and
version.</li>
</ul>
<p>(v1.0.3 is skipped because it was published with a bad URL, quickly fixed with
another version bump)</p>
<h2>Bug fixes - v1.0.2 (Mar 25 2014)</h2><ul>
<li>Use chokidar for watching file changes. This should fix a lot of problems on
OS X machines.</li>
<li>Always use / in paths when precompiling templates</li>
<li>Fix bug where async filters hang indefinitely inside if statements</li>
<li>Extensions now can override autoescaping with an autoescape property</li>
<li>Other various minor bugfixes</li>
</ul>
<h2>v1.0.1 (Dec 16, 2013)</h2><p>(no notes)</p>
<h2>We&#39;ve reached 1.0! Better APIs, asynchronous control, and more (Oct 24, 2013)</h2><ul>
<li>An asynchronous API is now available, and async filters, extensions, and
loaders is supported. The async API is optional and if you don&#39;t do anything
async (the default), nothing changes for you. You can read more about this
<a href="http://jlongster.github.io/nunjucks/api.html#asynchronous-support">here</a>. (fixes
<a href="https://github.com/mozilla/nunjucks/issues/41">#41</a>)</li>
<li>Much simpler higher-level API for initiating/configuring nunjucks is
available. Read more
<a href="http://jlongster.github.io/nunjucks/api.html#simple-api">here</a>.</li>
<li>An official grunt plugin is available for precompiling templates:
<a href="https://github.com/jlongster/grunt-nunjucks">grunt-nunjucks</a></li>
<li><strong>The browser files have been renamed.</strong> nunjucks.js is now the full library
with compiler, and nunjucks-slim.js is the small version that only works with
precompiled templates</li>
<li>urlencode filter has been added</li>
<li>The express integration has been refactored and isn&#39;t a kludge
anymore. Should avoid some bugs and be more future-proof;</li>
<li>The order in which variables are lookup up in the context and frame lookup
has been reversed. It will now look in the frame first, and then the
context. This means that if a for loop introduces a new var, like {% for name
in names %}, and if you have name in the context as well, it will properly
reference name from the for loop inside the loop. (fixes
<a href="https://github.com/mozilla/nunjucks/pull/122">#122</a> and
<a href="https://github.com/mozilla/nunjucks/issues/119">#119</a>)</li>
</ul>
<h2>v0.1.10 (Aug 9 2013)</h2><p>(no notes)</p>
<h2>v0.1.9 (May 30 2013)</h2><p>(no notes)</p>
<h2>v0.1.8 - whitespace controls, unpacking, better errors, and more! (Feb 6 2013)</h2><p>There are lots of cool new features in this release, as well as many critical
bug fixes.</p>
<p>Full list of changes:</p>
<ul>
<li>Whitespace control is implemented. Use {%- and -%} to strip whitespace before/after the block.</li>
<li><p><code>for</code> loops implement Python-style array unpacking. This is a really nice
feature which lets you do this:</p>
<p>  {% for x, y, z in [[2, 2, 2], [3, 3, 3]] %}</p>
<pre><code>--{{ x }} {{ y }} {{ z }}--
</code></pre><p>  {% endfor %}</p>
<p>The above would output: --2 2 2----3 3 3--</p>
<p>You can pass any number of variable names to for and it will destructure each
array in the list to the variables.</p>
<p>This makes the syntax between arrays and objects more
consistent. Additionally, it allows us to implement the <code>dictsort</code> filter
which sorts an object by keys or values. Technically, it returns an array of
2-value arrays and the unpacking takes care of it. Example:</p>
<p>  {% for k, v in { b: 2, a: 1 } %}</p>
<pre><code>--{{ k }}: {{ v }}--
</code></pre><p>  {% endfor %}</p>
<p>Output: <code>--b: 2----a: 1--</code> (note: the order could actually be anything
because it uses javascript’s <code>for k in obj</code> syntax to iterate, and ordering
depends on the js implementation)</p>
<p>  {% for k, v in { b: 2, a: 1} | dictsort %}</p>
<pre><code>--{{ k }}: {{ v }}--
</code></pre><p>  {% endfor %}</p>
<p>Output: <code>--a: 1----b: 2--</code></p>
<p>The above output will always be ordered that way. See the documentation for
more details.</p>
<p>Thanks to novocaine for this!</p>
</li>
<li><p>Much better error handling with at runtime (shows template/line/col information for attempting to call undefined values, etc)</p>
</li>
<li>Fixed a regression which broke the {% raw %} block</li>
<li>Fix some edge cases with variable lookups</li>
<li>Fix a regression with loading precompiled templates</li>
<li>Tweaks to allow usage with YUICompressor</li>
<li>Use the same error handling as normal when precompiling (shows proper errors)</li>
<li>Fix template loading on Windows machines</li>
<li>Fix int/float filters</li>
<li>Fix regression with super()</li>
</ul>
<h2>v0.1.7 - helpful errors, many bug fixes (Dec 12 2012)</h2><p>The biggest change in v0.1.7 comes from devoidfury (thanks!) which implements
consistent and helpful error messages. The errors are still simply raw text,
and not pretty HTML, but they at least contain all the necessary information to
track down an error, such as template names, line and column numbers, and the
inheritance stack. So if an error happens in a child template, it will print
out all the templates that it inherits. In the future, we will most likely
display the actual line causing an error.</p>
<p>Full list of changes:</p>
<ul>
<li>Consistent and helpful error messages</li>
<li>Expressions are more consistent now. Previously, there were several places
that wouldn’t accept an arbitrary expression that should. For example, you
can now do {% include templateNames[&#39;foo&#39;] %}, whereas previously you could
only give it a simply variable name.</li>
<li>app.locals is fixed with express 2.5</li>
<li>Method calls on objects now have correct scope for this. Version 0.1.6 broke
this and this was referencing the global scope.</li>
<li>A check was added to enforce loading of templates within the correct
path. Previously you could load a file outside of the template with something
like ../../crazyPrivateFile.txt</li>
</ul>
<p>You can
<a href="https://github.com/jlongster/nunjucks/compare/v0.1.6...v0.1.7">view all the code changes here</a>. Please
<a href="https://github.com/jlongster/nunjucks/issues?page=1&amp;state=open">file an issue</a>
if something breaks!</p>
<h2>v0.1.6 - undefined handling, bugfixes (Nov 13, 2012)</h2><p>This is mostly a bugfix release, but there are a few small tweaks based on
feedback:</p>
<ul>
<li>In some cases, backslashes in the template would not appear in the
output. This has been fixed.</li>
<li>An error is thrown if a filter is not found</li>
<li>Old versions of express are now supported (2.5.11 was tested)</li>
<li>References on undefined objects are now suppressed. For example, {{ foo }},
{{ foo.bar }}, {{ foo.bar.baz }} all output nothing if foo is
undefined. Previously only the first form would be suppressed, and a cryptic
error thrown for the latter 2 references. Note: I believe this is a departure
from jinja, which throws errors when referencing undefined objects. I feel
that this is a good and non-breaking addition though. (thanks to devoidfury)</li>
<li>A bug in set where you couldn’t not reference other variables is fixed
(thanks chriso and panta)</li>
<li>Other various small bugfixes</li>
</ul>
<p>You can view
<a href="https://github.com/jlongster/nunjucks/compare/v0.1.5...v0.1.6">all the code changes here</a>. As
always, <a href="https://github.com/jlongster/nunjucks/issues">file an issue</a> if
something breaks!</p>
<h2>v0.1.5 - macros, keyword arguments, bugfixes (Oct 11 2012)</h2><p>v0.1.5 has been pushed to npm, and it’s a big one. Please file any issues you
find, and I’ll fix them as soon as possible!</p>
<ul>
<li>The node data structure has been completely refactored to reduce redundancy
and make it easier to add more types in the future.</li>
<li>Thanks to Brent Hagany, macros now have been implemented. They should act
exactly the way jinja2 macros do.</li>
<li>A calling convention which implements keyword arguments now exists. All
  keyword args are converted into a hash and passed as the last
  argument. Macros needed this to implement keyword/default arguments.</li>
<li>Function and filter calls apply the new keyword argument calling convention</li>
<li>The “set” block now appropriately only sets a variable for the current scope.</li>
<li>Many other bugfixes.</li>
</ul>
<p>I’m watching this release carefully because of the large amount of code that
has changed, so please
<a href="https://github.com/jlongster/nunjucks/issues">file an issue</a> if you have a
problem with it.</p>
